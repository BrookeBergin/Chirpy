<!DOCTYPE html>
<html>
    <head>
        <title>Chirpy</title>
    </head>
    <style>

        html, body {
            background-color: white;
            width: 100%;
            margin: 0;
        }

        #container {
            background-color: rgb(255, 253, 247);
            border: 1px solid grey;            
            box-shadow: 3px 5px lightgrey;
            display: flex;           
            flex-direction: row;
            width: 98vw;  
            min-height: 98vh;            
            margin: auto;
            position: absolute;
            left: 1vw;
        }

        #column1 {
            width: 10%;
            background: #f4f4f4;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        #column2{
            width: 60%;
            padding: 20px;
            border-left: 1px solid #ddd;
        }

        #column3 {
            width: 30%;
            padding: 20px;
            border-left: 1px solid #ddd;
            align-content: center;
        }

        #upper-half {
            display: flex;
            flex-direction: column;     
            justify-content: center; 
            align-items: center;
            flex: 30;
            text-align: center;
            width: 100%;              
            height: 60%; 
        }

        .tagline{
            color: #fdd85d;
            font-family:Georgia, 'Times New Roman', Times, serif;
            font-style: italic;
            font-stretch: expanded;
            font-size: 1.7vw;
            font-weight: 900;
            text-shadow: 1px 1px rgb(134 134 134);
            margin-bottom: 30px;
            border-bottom: 0.5px solid rgba(45, 35, 66, 0.4);
            max-width: 70%;
            padding-bottom: 30px;
        }

        #welcome{
            font-size: 1.7vw;
            margin-bottom: 30px;
            border-bottom: 0.5px solid rgba(45, 35, 66, 0.4);
            padding-bottom: 30px;
        }


        #lower-half {
            display: flex;
            flex-direction: column;     
            justify-content: space-between;
            margin-bottom: 20px; 
            align-items: center;
            flex: 70;
            text-align: center;
            width: 100%;              
            height: 60%; 
        }

        #buttons-div
        {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .button-style{
            width: 30%;
            height: 48px;
            font-family: arial, Verdana, 'Segoe UI', Tahoma, Geneva, sans-serif;
            border-width: 0;
            padding: 10px;
            background-color: #FCFCFD;
            text-decoration: none;
            font-size: 1vw;
            border-radius: 50px;
            box-shadow: rgba(45, 35, 66, 0.4) 0 2px 4px,
                        rgba(45, 35, 66, 0.3) 0 7px 13px -3px,
                        #D6D6E7 0 -3px 0 inset;
            box-sizing: border-box;
            color: #36395A;
            cursor: pointer;
            display: inline-flex;
            justify-content: center;
            align-items: center;
        }

        .button-style:hover{
            box-shadow: rgba(45, 35, 66, 0.4) 0 4px 8px, 
                        rgba(45, 35, 66, 0.3) 0 7px 13px -3px, 
                        #fdd85d 0 -3px 0 inset;
            transform: translateY(-2px);
        }

        #prompt{
            margin-top: 20px;
            margin-bottom: 5px;
            font-style: italic;
        }

        #loginForm{
            display:flex;
            flex-direction: column;
            justify-content: center;
        }

        .form-element{
            display: flex;
            flex-direction: row;
            padding: 5px;
        }

        #form-div{
            width: 45%;
        }

        .form-prompt{
            flex: 30;
            font-family: arial, Verdana, 'Segoe UI', Tahoma, Geneva, sans-serif;
        }

        .form-entry{
            flex: 70;
        }

        

        #newUser{
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            justify-content: flex-end;
        }
        #search-bar {
            margin-bottom: 15px;
            display: flex;
            gap: 8px;
            justify-content: center;
            border-bottom: 0.5px solid rgba(45, 35, 66, 0.4);
            padding-bottom: 30px;
        }

        .chirp {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            background-color: white;
        }

        .chirp img {
            max-width: 100%;
            max-height: 300px;
            margin-top: 10px;
            border-radius: 5px;
        }

        .chirp-msg{
            border-top: 0.5px solid rgba(45, 35, 66, 0.4);
            padding-top: 10px;
        }

        .follow-button {
            background-color: #fdd85d;
            color: black;
            border: none;
            padding: 5px 10px;
            font-size: 14px;
            cursor: pointer;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .follow-button:hover {
            background-color: #e6c14c;
        }

        #chirp-form {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        #chirp-form textarea {
            width: 100%;
            max-width: 500px;
                }

        #chirp-form input[type="file"] {
            margin-top: 5px;
        }

        #chirp-form input[type="submit"] {
            margin-top: 10px;
        }
        
        
    </style>

    <body>
        <div id="container">
            <div id="column1">
                <p class="tagline">Chirpy</p>                
                <!-- <a class="button-style" style="width: 100px;white-space: nowrap;margin-bottom: 10px;">Home</a> -->
                <form method="GET" action="/feedPage/" style="margin-bottom: 10px;">
                    <input type="hidden" name="home" value="true">
                    <button type="submit" class="button-style" style="width: 100px; white-space: nowrap;">Home</button>
                </form>
                <a href="/logout" class="button-style" style="width: 100px; white-space: nowrap;">Log out</a>
                <br>
                <h3>People You Follow</h3>
                <ul>
                    <#if username??>
                        <#assign currentUser = userService.getUserByUsername(username)>
                        <#if currentUser.following?? && currentUser.following?size > 0>
                            <#list currentUser.following as following>
                                <li>${following.username}</li>
                            </#list>
                        <#else>
                            <li>No one to follow yet!</li>
                        </#if>
                    <#else>
                        <li>You must be logged in to view your followings.</li>
                    </#if>
                </ul>
            </div>
            <div id="column2">
                <h3 id="welcome">${message}</h3>
                <div id="search-bar">
                    <form method="GET" action="/feedPage/" style="width: 60%;">
                        <input type="text" name="searchTerm"  style="width: 60%;" placeholder="Search by username or #hashtag">
                        <input type="submit" value="Search">
                    </form>
                </div>
                <div id="chirp-timeline">
                    <#if searchTerm??>
                        <h2>Search results for: ${searchTerm}</h2>
                    <#elseif home?? || !searchTerm??>
                        <h2>Posts from people you follow</h2>
                    <#else>
                        <h2>Timeline</h2>
                    </#if>
                    <!-- Back-end note: home should be a boolean flag passed into the template when the user visits the home route or after a search is cleared. -->

                    <#if chirps?has_content>
                        <#list chirps as chirp>
                            <div class="chirp">
                                <p><strong>${chirp.username}</strong> at ${chirp.timestamp?string("MM/dd/yyyy HH:mm:ss")}</p>
                                <form method="GET" action="/feedPage/">
                                    <input type="hidden" name="follow" value="${chirp.username}"/>
                                    <button type="submit" class="follow-button">Follow</button>
                                </form>
                                <p class="chirp-msg">${chirp.message}</p>
                                <#if chirp.imageFilename?? && chirp.imageFilename?length != 0>
                                    <img src="/uploads/${chirp.imageFilename}" alt="Chirp Image" style="max-width: 300px; max-height: 300px; margin-top: 10px;">
                                </#if>
                            </div>
                        </#list>
                    <#else>
                        <p>No chirps yet.</p>
                    </#if>
                </div>
            </div>
            <div id="column3">
                <h3>Post a Chirp</h3>
                <div id="chirp-form">
                    <form method="post" action="/feedPage/" enctype="multipart/form-data">
                        <textarea name="chirpMessage" rows="3" cols="50" placeholder="What's on your mind?"></textarea><br>
                        <input type="file" name="chirpImage"><br>
                        <input type="submit" value="Post Chirp" class="button-style" style="width: 100px; white-space: nowrap; margin-top: 20px;">
                    </form>
                </div>
            </div>

        </div>
        
    </body>
</html>
